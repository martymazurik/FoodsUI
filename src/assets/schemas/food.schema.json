{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://yourdomain.com/schemas/food-response.json",
  "title": "Food API Response",
  "description": "Complete food information including nutrition facts, brand info, and metadata",
  "type": "object",
  "properties": {
    "id": {
      "type": "number",
      "description": "Internal food ID"
    },
    "description": {
      "type": "string",
      "minLength": 1,
      "description": "Food description/name as searched"
    },
    "foodRequestType": {
      "type": "string",
      "enum": ["brand", "whole", "recipe", "unknown"],
      "description": "Classification of food type"
    },
    "nutritionFacts": {
      "type": ["object", "null"],
      "description": "FDA nutrition facts per serving",
      "properties": {
        "foodName": { 
          "type": "string", 
          "description": "Product name / description" 
        },
        "servingSizeHousehold": { 
          "type": "string", 
          "description": "Common household measure, e.g., '2/3 cup', '1 container'" 
        },
        "servingSizeG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Metric weight of serving in grams (g)" 
        },
        "servingsPerContainer": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Number of servings per container" 
        },
        "calories": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Calories per serving" 
        },
        "totalFatG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Total fat (g)" 
        },
        "saturatedFatG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Saturated fat (g)" 
        },
        "transFatG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Trans fat (g)" 
        },
        "cholesterolMG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Cholesterol (mg)" 
        },
        "sodiumMG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Sodium (mg)" 
        },
        "totalCarbohydrateG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Total carbohydrate (g)" 
        },
        "dietaryFiberG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Dietary fiber (g)" 
        },
        "totalSugarsG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Total sugars (g)" 
        },
        "addedSugarsG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Added sugars (g)" 
        },
        "proteinG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Protein (g)" 
        },
        "vitaminDMcg": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Vitamin D (mcg)" 
        },
        "calciumMG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Calcium (mg)" 
        },
        "ironMG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Iron (mg)" 
        },
        "potassiumMG": { 
          "type": "number", 
          "minimum": 0, 
          "description": "Potassium (mg)" 
        },
        "ingredients": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of ingredients from product label"
        },
        "fieldVerificationFlags": {
          "type": ["object", "null"],
          "additionalProperties": {
            "type": "string",
            "enum": ["unknown", "NutritionixAPI", "ProductLabel", "AIModel"]
          },
          "description": "Verification status for individual fields"
        }
      },
      "additionalProperties": false
    },
    "servingSizeMultiplicand": {
      "type": "number",
      "minimum": 0,
      "description": "Multiplier for serving size calculations"
    },
    "dataSource": {
      "type": "string",
      "description": "Source of nutrition data (e.g., 'OpenAI-Brand', 'Nutritionix')"
    },
    "enhancedAt": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When the record was enhanced/created"
    },
    "verifiedType": {
      "type": "string",
      "enum": ["unknown", "NutritionixAPI", "ProductLabel", "AIModel"],
      "description": "Verification method for nutrition data"
    },
    "verifiedDate": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "When the data was verified"
    },
    "verifiedBy": {
      "type": "string",
      "description": "Who/what verified the data"
    },
    "foodImage": {
      "type": "string",
      "description": "GridFS ObjectID for product image"
    },
    "foodImageThumbnail": {
      "type": "string",
      "description": "GridFS ObjectID for product image thumbnail"
    },
    "nutritionFactsImage": {
      "type": "string",
      "description": "GridFS ObjectID for nutrition facts label image"
    },
    "nutritionFactsImagePending": {
      "type": "string",
      "description": "GridFS ObjectID for nutrition facts image pending processing"
    },
    "nutritionFactsStatus": {
      "type": "string",
      "enum": ["pending", "processing", "completed", "error"],
      "description": "Status of nutrition facts processing/OCR"
    },
    "tokensUsed": {
      "type": ["number", "null"],
      "minimum": 0,
      "description": "AI tokens consumed for this food"
    },
    "estimatedCost": {
      "type": ["number", "null"],
      "minimum": 0,
      "description": "Estimated cost in USD for AI processing"
    },
    "brandInfo": {
      "type": ["object", "null"],
      "description": "Brand and manufacturer information",
      "properties": {
        "manufacturer": {
          "type": "string",
          "description": "Product manufacturer"
        },
        "parentCompany": {
          "type": "string",
          "description": "Parent company name"
        },
        "officialSites": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Official brand websites"
        },
        "nutritionSiteCandidates": {
          "type": "array",
          "items": { "type": "string" },
          "description": "URLs with potential nutrition information"
        },
        "productImageSiteCandidates": {
          "type": "array",
          "items": { "type": "string" },
          "description": "URLs with potential product images"
        },
        "productLine": {
          "type": "string",
          "description": "Product line or series name"
        }
      },
      "additionalProperties": false
    },
    "recipe": {
      "type": ["object", "null"],
      "description": "Recipe information for recipe-type foods",
      "properties": {
        "name": { "type": "string" },
        "description": { "type": "string" },
        "totalWeightG": { "type": "number", "minimum": 0 },
        "servings": { "type": "number", "minimum": 1 },
        "ingredients": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "quantity": { "type": "number" },
              "unit": { "type": "string" },
              "preparation": { "type": "string" },
              "amount": { "type": "number" },
              "weightG": { "type": "number" },
              "calories": { "type": "number" },
              "totalFatG": { "type": "number" },
              "proteinG": { "type": "number" },
              "carbsG": { "type": "number" }
            },
            "required": ["name", "quantity", "unit", "preparation", "amount", "weightG", "calories", "totalFatG", "proteinG", "carbsG"],
            "additionalProperties": false
          }
        },
        "instructions": { "type": "string" }
      },
      "required": ["name", "description", "totalWeightG", "servings", "ingredients", "instructions"],
      "additionalProperties": false
    }
  },
  "required": [
    "id",
    "description", 
    "foodRequestType",
    "servingSizeMultiplicand",
    "dataSource",
    "verifiedType",
    "verifiedBy",
    "foodImage",
    "foodImageThumbnail",
    "nutritionFactsImage",
    "nutritionFactsImagePending",
    "nutritionFactsStatus"
  ],
  "additionalProperties": false
}